    
-----------

    UPDATE SCH_CENTRA_ID.CERTIFICATION_CAMPAIGNS_EXTERNAL_USERS_INDICATORS 
            SET 
                COUNT_EXTERNAL_USERS = t2.COUNT_EXTERNAL_USERS,
                COUNT_EXTERNAL_USERS_PENDING = t2.COUNT_EXTERNAL_USERS_PENDING,
                COUNT_EXTERNAL_USERS_KEEP = t2.COUNT_EXTERNAL_USERS_KEEP,
                COUNT_EXTERNAL_USERS_REMOVE = t2.COUNT_EXTERNAL_USERS_REMOVE,
                COUNT_EXTERNAL_USERS_CHANGE = t2.COUNT_EXTERNAL_USERS_CHANGE
                FROM (
                    SELECT
                    COUNT(*) AS COUNT_EXTERNAL_USERS,
                    COUNT(CASE WHEN t1.STATUS = 'PENDIENTE' THEN 1 END) AS COUNT_EXTERNAL_USERS_PENDING,
                    COUNT(CASE WHEN t1.STATUS = 'MANTENER' THEN 1 END) AS COUNT_EXTERNAL_USERS_KEEP,
                    COUNT(CASE WHEN t1.STATUS = 'ELIMINAR' THEN 1 END) AS COUNT_EXTERNAL_USERS_REMOVE,
                    COUNT(CASE WHEN t1.STATUS = 'CAMBIAR' THEN 1 END) AS COUNT_EXTERNAL_USERS_CHANGE
                    FROM SCH_CENTRA_ID.CERTIFICATION_CAMPAIGNS_EXTERNAL_USERS t1 WITH (NOLOCK)
                    WHERE t1.CERTIFICATION_CAMPAIGNS_ID=:certificationCampaignsId AND t1.USERDATA_RESPONSIBLE_ID=:userdataResponsibleId AND t1.VALID=1
                ) t2
                WHERE CERTIFICATION_CAMPAIGNS_ID=6 AND VALID=1

---------------------                
                
 UPDATE SCH_CENTRA_ID.CERTIFICATION_CAMPAIGNS_EXTERNAL_USERS_INDICATORS 
            SET 
                COUNT_EXTERNAL_USERS = t2.COUNT_EXTERNAL_USERS,
                COUNT_EXTERNAL_USERS_PENDING = t2.COUNT_EXTERNAL_USERS_PENDING,
                COUNT_EXTERNAL_USERS_KEEP = t2.COUNT_EXTERNAL_USERS_KEEP,
                COUNT_EXTERNAL_USERS_REMOVE = t2.COUNT_EXTERNAL_USERS_REMOVE,
                COUNT_EXTERNAL_USERS_CHANGE = t2.COUNT_EXTERNAL_USERS_CHANGE,
                COUNT_COUNTERPARTY = t2.COUNT_COUNTERPARTY,
                COUNT_EXTERNAL_USERS_WITHOUT_COUNTERPARTY = t2.COUNT_EXTERNAL_USERS_WITHOUT_COUNTERPARTY
                FROM (
                    SELECT
                    COUNT(*) AS COUNT_EXTERNAL_USERS,
                    COUNT(CASE WHEN t1.STATUS = 'PENDIENTE' THEN 1 END) AS COUNT_EXTERNAL_USERS_PENDING,
                    COUNT(CASE WHEN t1.STATUS = 'MANTENER' THEN 1 END) AS COUNT_EXTERNAL_USERS_KEEP,
                    COUNT(CASE WHEN t1.STATUS = 'ELIMINAR' THEN 1 END) AS COUNT_EXTERNAL_USERS_REMOVE,
                    COUNT(CASE WHEN t1.STATUS = 'CAMBIAR' THEN 1 END) AS COUNT_EXTERNAL_USERS_CHANGE,
                    COUNT(DISTINCT t1.USERDATA_RESPONSIBLE_ID ) COUNT_COUNTERPARTY,
                    COUNT(CASE WHEN t1.USERDATA_RESPONSIBLE_ID IS NULL THEN 1 END ) COUNT_EXTERNAL_USERS_WITHOUT_COUNTERPARTY
                    FROM SCH_CENTRA_ID.CERTIFICATION_CAMPAIGNS_EXTERNAL_USERS t1
                    WHERE t1.CERTIFICATION_CAMPAIGNS_ID=:certificationCampaignsId AND t1.VALID=1
                ) t2
            WHERE CERTIFICATION_CAMPAIGNS_ID=6 AND TYPE='G' AND VALID=1
            
                                
