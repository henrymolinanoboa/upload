--- =============================================
-- Author:    <Henry Molina>
-- Create date: <22/AGO/2024>
-- Description:  - Scripts para :
--        - Crear tabla para almacenar datos de los tickets de service now que se deben ejecutar.

-- Type: DDL
-- ===

IF OBJECT_ID(N'[SCH_CENTRA_ID].[TICKETS]', N'U') IS NULL 
BEGIN      
	CREATE TABLE SCH_CENTRA_ID.TICKETS
	    (
		ID BIGINT NOT NULL IDENTITY,
		GUID NVARCHAR(100)  NOT NULL,
		USERNAME NVARCHAR(50)  NOT NULL,
		ENDPOINT NVARCHAR(200)  NOT NULL,
		PAYLOAD TEXT  NOT NULL,
		STATUS NVARCHAR(20)  NOT NULL,
		DATE_CREATED DATETIME NOT NULL,
		DATE_PLANNED DATETIME,
		DATE_EXECUTE DATETIME,
		UUIDS TEXT ,
		DESCRIPTION TEXT ,
		CONSTRAINT TICKETS_PK PRIMARY KEY (ID)
	    )    
END
GO

IF OBJECT_ID(N'[SCH_CENTRA_ID].[TICKETS_HISTORY]', N'U') IS NULL 
BEGIN      
	CREATE TABLE
	    SCH_CENTRA_ID.TICKETS_HISTORY
	    (
		ID BIGINT NOT NULL IDENTITY,
		GUID NVARCHAR(100)  NOT NULL,
		DATE_EXECUTE DATETIME NOT NULL,
		RESPONSE TEXT  NOT NULL,
		HTTP_RESPONSE NVARCHAR(100) ,
		CONSTRAINT TICKETS_HISTORY_PK PRIMARY KEY (ID)
	    )    
END
GO








--------------------------------


--- =============================================
-- Author:    <Henry Molina>
-- Create date: <22/AGO/2024>
-- Description:  - Scripts para :
--        - Crear tabla para almacenar datos de los tickets de service now que se deben ejecutar --ROLLBACL

-- Type: DDL


IF OBJECT_ID(N'[SCH_CENTRA_ID].[TICKETS]', N'U') IS NOT NULL 
BEGIN      
    DROP TABLE SCH_CENTRA_ID.TICKETS 
END
GO

IF OBJECT_ID(N'[SCH_CENTRA_ID].[TICKETS_HISTORY]', N'U') IS NOT NULL 
BEGIN      
    DROP TABLE SCH_CENTRA_ID.TICKETS_HISTORY 
END
GO


