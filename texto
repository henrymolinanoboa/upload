SELECT 
TP.ID ID ,
1 VALID,
TP.CODE TRANSACTIONAL_PROFILE_CODE ,
TP.NAME TRANSACTIONAL_PROFILE_NAME,
GP.CODE GLOBAL_PROFILE_CODE,
GP.NAME GLOBAL_PROFILE_NAME,
A.CODE APPLICATION_CODE,
A.NAME APPLICATION_NAME,
C_NIVREGI.NAME TRANSACTIONAL_PROFILE_RISK_LEVEL,
CASE GP.VALID WHEN  1 THEN GP.STATUS ELSE 'ELIMINADO' END  GLOBAL_PROFILE_STATUS
FROM SCH_CENTRA_ID.GLOBAL_PROFILES GP
LEFT JOIN SCH_CENTRA_ID.GLOBAL_TRANSACTIONAL_PROFILES GTP ON GTP.GLOBAL_PROFILE_ID=GP.ID
LEFT JOIN SCH_CENTRA_ID.TRANSACTIONAL_PROFILES TP ON TP.ID = GTP.TRANSACTIONAL_PROFILE_ID
LEFT JOIN SCH_CENTRA_ID.APPLICATIONS A ON TP.APPLICATION_ID = A.ID
LEFT JOIN SCH_CENTRA_ID.APPLICATIONS_GROUP AG ON A.APPLICATION_GROUP_ID=AG.ID
LEFT JOIN SCH_CENTRA_ID.CATALOGS C_NIVREGI ON TP.CATALOG_RISK_LEVEL_ID=C_NIVREGI.ID
WHERE 
GTP.VALID=1 AND
TP.VALID=1
ORDER BY GP.NAME
OFFSET 0 ROWS
 FETCH NEXT 1000 ROWS ONLY
