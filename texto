16*AmFv*Bp



INSERT INTO SCH_CENTRA_ID.DEFAULT_PROFILES (
                GLOBAL_PROFILE_ID, 
                CODE_COMPANY, 
                CODE_DIVISION, 
                CODE_AREA, 
                CODE_DEPARTMENT, 
                CODE_POSITION, 
                VALID, 
                NAME_COMPANY, 
                NAME_DIVISION, 
                NAME_AREA, 
                NAME_DEPARTMENT, 
                NAME_POSITION,
                AUTOMATIC
            ) 
            SELECT
                GLOBAL_PROFILE_ID,
                :newCompanyCode,
                CASE WHEN CODE_DIVISION='ANY' THEN 'ANY' ELSE :newDivisionCode END ,
                CASE WHEN CODE_AREA='ANY' THEN 'ANY' ELSE :newAreaCode END,
                CASE WHEN CODE_DEPARTMENT='ANY' THEN 'ANY' ELSE :newDepartmentName END ,
                CODE_POSITION,
                1,
                :newCompanyName,
                :newDivisionName,
                :newAreaName,
                :newDepartmentName,
                NAME_POSITION,
                1
            FROM (
            SELECT 
                GLOBAL_PROFILE_ID,
                CODE_COMPANY,
                CODE_DIVISION,
                CODE_AREA,
                CODE_DEPARTMENT,
                CODE_POSITION,
                NAME_POSITION 
            FROM SCH_CENTRA_ID.DEFAULT_PROFILES
            WHERE VALID=1
                AND (CODE_COMPANY=:previousCompanyCode )
                AND (CODE_DIVISION=:previousDivisionCode OR CODE_DIVISION='ANY'  )
                AND (CODE_AREA=:previousAreaCode OR CODE_AREA='ANY'  )
                AND (CODE_DEPARTMENT=:previousDepartmentCode OR CODE_DEPARTMENT='ANY')
            ) t
            WHERE T.CODE_DIVISION!='ANY' OR T.CODE_AREA!='ANY' OR T.CODE_DEPARTMENT!='ANY'
